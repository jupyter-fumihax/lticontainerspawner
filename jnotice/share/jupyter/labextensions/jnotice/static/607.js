window._JUPYTERLAB=window._JUPYTERLAB||{},(self.webpackChunkjnotice=self.webpackChunkjnotice||[]).push([[607],{607:(t,e,n)=>{n.r(e),n.d(e,{default:()=>a});var o=n(622);const a={id:"jnotice:plugin",autoStart:!0,activate:async t=>{const e=document.getElementById("jupyter-config-data"),n=e?.textContent??"",a=n?JSON.parse(n):{},i=a.jnotice??a.page_config_data?.jnotice??a.pageConfig?.jnotice??{},s=o.PageConfig.getBaseUrl?.()??"",c=(location.pathname.match(/\/user\/[^/]+\/?/)?.[0]||"/").replace(/\/?$/,"/");let r=(a.baseUrl||s||c).replace(/\/?$/,"/");const l=r.match(/^\/hub\/(user\/[^/]+\/)/);l&&(r="/"+l[1]);const d=(location.pathname.match(/\/user\/[^/]+\/?/)?.[0]||"").replace(/\/?$/,"/");d&&(r=d);const p="string"==typeof i.path&&i.path.trim()?i.path:".jnotice.txt",u="string"==typeof i.stickyPath&&i.stickyPath.trim()?i.stickyPath:".jnotice.sticky.txt",h=Number.isFinite(i.pollMs)?Number(i.pollMs):6e4,m=document.cookie.match(/(?:^|; )_xsrf=([^;]+)/)?.[1]||"",b=r+"files/"+p.replace(/^\/+/,""),x=r+"files/"+u.replace(/^\/+/,""),g=window.setTimeout.bind(window),y=window.clearTimeout.bind(window),f=window.fetch.bind(window);let w,k="",C=null;function T(t){t.style.opacity="0";const e=()=>t.remove();t.addEventListener("transitionend",e,{once:!0}),g(e,350)}async function j(){try{const t={};m&&(t["X-XSRFToken"]=m);let e=!1;try{const n=await f(x+"?_="+Date.now(),{cache:"no-store",credentials:"same-origin",headers:t});if(424!==n.status){const t=n.url||"",o=(n.headers.get("Content-Type")||"").toLowerCase();if(n.redirected||/\/hub\/login|oauth_callback/.test(t)||o.includes("text/html")||!n.ok)404!==n.status&&410!==n.status||(C&&(T(C),C=null),k="");else{const t=(await n.text()).trim();t?(e=!0,t!==k&&(C&&(T(C),C=null),C=function(t){const e=document.createElement("div");e.setAttribute("role","status"),e.setAttribute("aria-live","polite"),e.style.cssText=["position:fixed","right:20px","bottom:20px","background:#cfe9ff","color:#122","padding:12px 16px","border-left:6px solid #2b6cb0","border-radius:10px","box-shadow:0 2px 8px rgba(0,0,0,.2)","z-index:9999","max-width:420px","display:flex","align-items:flex-start","gap:10px","opacity:1","transition:opacity 300ms ease"].join(";")+";";const n=document.createElement("span");n.textContent=t,n.style.cssText="line-height:1.5;",e.appendChild(n);const o=document.createElement("button");return o.type="button",o.setAttribute("aria-label","close"),o.textContent="×",o.style.cssText=["border:none","background:transparent","font-size:18px","cursor:pointer","line-height:1","padding:4px","margin-left:auto","border-radius:6px"].join(";")+";",o.onmouseenter=()=>o.style.backgroundColor="rgba(0,0,0,.06)",o.onmouseleave=()=>o.style.backgroundColor="transparent",o.onclick=()=>{T(e),C=null},e.appendChild(o),document.body.appendChild(e),e}(t),k=t)):(C&&(T(C),C=null),k="")}}}catch{}try{const n=await f(b+"?_="+Date.now(),{cache:"no-store",credentials:"same-origin",headers:t});if(424===n.status)return;const o=n.url||"",a=(n.headers.get("Content-Type")||"").toLowerCase();if(!(n.redirected||/\/hub\/login|oauth_callback/.test(o)||a.includes("text/html"))&&n.ok){const t=(await n.text()).trim();if(!t)return;e||function(t){const e=document.createElement("div");e.setAttribute("role","status"),e.setAttribute("aria-live","polite"),e.style.cssText=["position:fixed","right:20px","bottom:20px","background:#ffefc6","color:#222","padding:10px 14px","border-radius:10px","box-shadow:0 2px 8px rgba(0,0,0,.2)","z-index:9999","max-width:360px","display:flex","align-items:center","gap:8px","opacity:1","transition:opacity 300ms ease"].join(";")+";";const n=document.createElement("span");n.textContent=t,n.style.cssText="line-height:1.4;",e.appendChild(n);const o=document.createElement("button");o.type="button",o.setAttribute("aria-label","close"),o.textContent="×",o.style.cssText=["border:none","background:transparent","font-size:16px","cursor:pointer","line-height:1","padding:4px","margin-left:auto","border-radius:6px"].join(";")+";",o.onmouseenter=()=>o.style.backgroundColor="rgba(0,0,0,.06)",o.onmouseleave=()=>o.style.backgroundColor="transparent",o.onclick=()=>T(e),e.appendChild(o),document.body.appendChild(e),g(()=>T(e),6e4)}(t),await async function(){const t=p.replace(/^\/+/,"").split("/").map(encodeURIComponent).join("/"),e=r+"api/contents/"+t;try{const t={"Content-Type":"application/json"};m&&(t["X-XSRFToken"]=m);const n=await f(e,{method:"DELETE",credentials:"same-origin",headers:t});if(n.ok||204===n.status)return}catch{}try{const t={"Content-Type":"application/json"};m&&(t["X-XSRFToken"]=m),await f(e,{method:"PUT",credentials:"same-origin",headers:t,body:JSON.stringify({type:"file",format:"text",content:""})})}catch{}}()}}catch{}}catch{}}function E(){w=g(async()=>{try{await j()}finally{E()}},h)}g(()=>{j(),E()},1e3),document.addEventListener("visibilitychange",()=>{document.hidden||j()}),window.addEventListener("pageshow",()=>{j()}),window.addEventListener("beforeunload",()=>{w&&y(w)}),console.log(`[jnotice] plugin loaded; polling "${p}" and sticky "${u}" every ${h} ms`)}}}}]);